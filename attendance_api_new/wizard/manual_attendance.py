# -*- coding: utf-8 -*-from odoo import api, fields, models, _from datetime import datetime, time, timedeltafrom odoo.exceptions import ValidationErrorclass ManualAttendance(models.TransientModel):    _name = "manual.attendance"    _description = "Manual Attendance"    date_from = fields.Date(string="From", required=True)    date_to = fields.Date(string="To", required=True)    type = fields.Selection(string="Type", default='attendance',                            selection=[('attendance', 'Create Attendance'),                                       ('justification', 'Re-Calculate Justification')])    employee_ids = fields.Many2many(comodel_name="hr.employee", string="Employees")    def action_confirm(self):        self.ensure_one()        employees = self.employee_ids        if not employees:            employees = self.env['hr.employee'].search([])        date_to = self.date_to        date_from = self.date_from        if self.type == 'justification':            to_date_time = datetime.combine(date_to, time(23, 59, 59))            domain = [('employee_id', 'in', employees.ids), ('check_in', '<=', to_date_time)]            if date_from:                from_date_time = datetime.combine(date_from, time(0, 0, 0))                domain.append(('check_in', '>=', from_date_time))            self.env['hr.attendance'].search(domain).unlink()        self.env['hr.attendance'].with_context(cron_job=False).download_attendance_from_machine(date_from, date_to, employees)    @api.constrains('date_from', 'date_to')    def _check_dates_validation(self):        self.ensure_one()        if self.date_to and self.date_from and self.date_from > self.date_to:            raise ValidationError(_("Date to must be greater than date from ........."))        if self.date_to > fields.Date.today():            raise ValidationError(_("Date to must be greater than today ........."))        if self.date_to == fields.Date.today() and not self.env.user.has_group('base.group_erp_manager'):            raise ValidationError(_("Date to must earlier than today ........."))